# CD取り込み自動化ワークフロー GUI v1.0

音楽CDの取り込みから各種フォーマット変換、タグ付け、アートワーク処理、NAS転送までを一元管理するGUIアプリケーションです。

## ⚠️ 重要な注意事項

**このアプリケーションは個人的な使用を目的として開発されたものです。**

- 作者自身のワークフローに最適化されており、他の環境での動作は保証されません
- 使用は自己責任でお願いします
- データの損失や破損が発生する可能性があります
- **必ず重要なデータはバックアップしてからご使用ください**
- 外部ツールの動作や互換性については各ツールの公式ドキュメントを参照してください

## 主な機能

### 8ステップのワークフロー管理

- **Step 0**: Music Center取り込みガイド（参考情報）
- **Step 1**: 新規アルバム取り込み（フォルダ選択・state.json生成）
- **Step 2**: Demucs処理（ボーカル分離・インスト版作成）
- **Step 3**: タグ付け・リネーム（Mp3tag連携・ReplayGain自動適用）
- **Step 4**: AAC変換（MediaHuman Audio Converter連携）
- **Step 5**: Opus変換（foobar2000連携）
- **Step 6**: アートワーク最適化（ImageMagick連携）
- **Step 7**: NAS転送（WinSCP連携・クリーンアップ）

### 便利な機能

- **自動進捗管理**: 各アルバムの進行状況を`state.json`で自動保存
- **ステップロールバック**: 前のステップに戻してやり直し可能
- **作業破棄**: アルバムフォルダをゴミ箱へ安全に移動
- **設定GUI**: config.iniの各種設定をGUIで編集可能
- **ログビューア**: 処理履歴を確認可能
- **自動スキップ**: インスト版楽曲のDemucs処理を自動除外

## システム要件

- **OS**: Windows 10/11
- **Python**: 3.12以降
- **外部ツール**（パスは設定GUIで指定可能）:
  - Mp3tag
  - MediaHuman Audio Converter
  - foobar2000
  - WinSCP
  - FreeFileSync
  - flac/metaflac
  - ImageMagick
  - demucs（Pythonパッケージ、オプション）

## インストール

### 1. リポジトリのクローン

```bash
git clone https://github.com/SyameimaruKoa/RipTagOptimize.git
cd RipTagOptimize
```

### 2. 起動（初回自動セットアップ）

```cmd
LAUNCH_GUI.bat
```

初回実行時は自動で以下を実行します：
- Python仮想環境（.venv）の作成
- 必要なライブラリのインストール

## 使い方

### 基本的なワークフロー

1. **LAUNCH_GUI.bat** を実行してGUIを起動
2. **Step 1**で新規アルバムフォルダを選択
3. 各ステップを順番に実行
4. 外部ツールを起動して処理を実行
5. 「完了」ボタンで次のステップへ進む

### 設定

ツールバーの「⚙️ 設定」から以下を設定できます：

- **ツールパス**: 各外部ツールの実行ファイルパス
- **品質設定**: アートワークのJPEG/WebP品質、リサイズ幅
- **Demucs設定**: 自動除外キーワード（動的追加・削除可能）

### ロールバック機能

ステップを間違えた場合：

1. 対象アルバムを左のリストから選択
2. ツールバーの「⏪ 前ステップへ」をクリック
3. 前のステップに戻ります（完了フラグもクリア）

※ Step 2未満には戻せません

## （オプション）Demucsによるボーカル除去

RipTagOptimize は、Demucs（AI音源分離）で生成された `no_vocals.wav` （インスト音源）を検出し、タグ付けやエンコードの対象とします。インスト音源が既に用意されている場合は Step 1 でフォルダを取り込み、未生成なら Step 2 で対象トラックを選択した上で外部環境（ローカルGPU環境など）で Demucs を実行し、完了後に成果物フォルダを指定してください。

### ローカル実行について
Step 2 ではローカルにインストールされた Demucs を用いて `no_vocals.wav` / `minus_vocals.flac` を生成できます。
- 生成されたインスト音源は FLAC へ変換後 `(Inst)` 付きファイル名で統合されます

## ディレクトリ構造

```
work/
  └─ [ArtistName] - [AlbumName]/  ← アルバムフォルダ
       ├─ state.json              ← 進捗管理ファイル
       ├─ 01 - Track.flac         ← 完成品FLAC
       ├─ 02 - Track (Inst).flac  ← Demucs成果物
       ├─ _flac_src/              ← (Step1) 生FLAC置き場
       ├─ htdemucs_ft/            ← (Step2) Demucs出力
       ├─ _aac_output/            ← (Step4) AAC出力先
       ├─ _opus_output/           ← (Step5) Opus出力先
       ├─ _artwork_resized/       ← (Step6) リサイズ画像
       └─ _logs/                  ← 自動処理ログ
```

## トラブルシューティング

### GUIが起動しない

- Python 3.12以降がインストールされているか確認
- `.venv`フォルダを削除して`LAUNCH_GUI.bat`を再実行

### 外部ツールが起動しない

- 設定GUIで各ツールのパスが正しく設定されているか確認
- ツールが実際にインストールされているか確認

### ステップが進まない

- 各ステップの「完了」ボタンを押しているか確認
- ログビューア（📋 ログ表示）でエラーを確認

## 開発情報

- **Language**: Python 3.12
- **GUI Framework**: PySide6 (Qt for Python)
- **State Management**: JSON
- **Version Control**: Git

## ライセンス

MIT License

## 免責事項

このソフトウェアは「現状のまま」提供され、明示または黙示を問わず、いかなる保証もありません。作者は、このソフトウェアの使用によって生じたいかなる損害についても責任を負いません。

**本アプリケーションは作者個人の使用を目的として開発されたものであり、汎用性や互換性は保証されません。ご使用の際は必ず事前にバックアップを取り、自己責任でご利用ください。**

## 作者

YOUR_NAME

## 更新履歴

詳細は [CHANGELOG.md](CHANGELOG.md) を参照してください。
